---

- name: Push Supervisor configurations
  template:
    src: supervisor/{{ item }}.conf.j2
    dest: /etc/supervisor/conf.d/{{ item }}.conf
  with_items:
    - osp-www-prod
    - osp-www-dev

- name: Restart Supervisor
  service:
    name: supervisor
    state: restarted

- name: Wait for Supervisor
  pause: seconds=3

- name: Start Supervisor programs
  supervisorctl:
    name: '{{ item }}'
    state: restarted
  with_items: osp_www_procs
